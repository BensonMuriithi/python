from string import lower
from time import sleep
from ex36_bens_part3 import die
from ex36_bens_part3 import wake_peter
from ex36_bens_part3 import final_sequence

def call_of_help(can_help, has_called_ambulance):
	sleep(4.2)
	print "\n\"HELP! HELP! HELP!\""
	print "The sounds are coming from the car halted ahead of yours."
	print "\"HELP! HEELP! HEEELP!\""
	print "The sound is getting more intense and you worry the person might be in dire distress."
	print "What do you do?"
	
	to_help = lower(raw_input("> "))
	if "go" in to_help or "out" in to_help or "help" in to_help:
		try_to_help(can_help, has_called_ambulance)
	elif "listen" in to_help or "wait" in to_help or "hear" in to_help:
		call_of_help(can_help, has_called_ambulance)
	else:
		if(has_called_ambulance):
			ambulance_arrive(False)
		else:
			die(False)
			
def try_to_help(can_help, has_called_ambulance):
	if(can_help):
		sleep(2)
		print """
You try as hard as you can to lift the dashboard off your legs
Your legs slowly get free and you struggle out of the car carefully to avoid hurting yourself
Steadily you manage to pull yourself from the car and get to your feet
You limp towards the other wreck.
		"""
		sleep(3)
		print """
You get to an overturned SUV
You crouch to look into the car and see if there's a person inside
There's a lady suspended upside down by her seatbelt
She looks anxiously at you.\n
"OH THANK YOU! PLEASE CHECK IF MY SON IS OKAY!"
"PLEASE CHECK IF HE'S OKAY! HE'S IN THE BACK PLEASE CHECK IF HE'S OKAY!"
"OH, GOD!!"
		"""
		pp(False, has_called_ambulance)
		
	else:
		print """
You try to lift the dashboard off of your legs
You scream in pain as a sharp pain comes from your shoulder.
You fear that if you push yourself you will injure yourself badly
		"""
		if(not has_called_ambulance):
			print "You think of calling ambulance. Do you?"
			call = lower(raw_input("> "))
			if "no" in call or "don't" in call:
				die(False)
			elif "yes" in call or "yeah" in call or "okay" in ambulance:
				ambulance_arrive(False)
		else:
			ambulance_arrive(False)
			

def pp(had_refused, has_called_ambulance):
	save_boy = lower(raw_input("Please do something! >>> " if had_refused else "Do something! >>> "))
	if "back" in save_boy or "save" in save_boy or "help" in save_boy or "rush" in save_boy or "check" in save_boy or "look" in save_boy:
		print """
There's a young boy seemingly below 6 years old suspended in a seat-belt
As you fear his demise you notice that he has a thick jacket that could have protected his body
You tell the boy's mother that the boy could be alright.
Holding on to your own hope, the mother is struggling to not break down in sorrow.
		"""
		helping_boy(has_called_ambulance)
	else:
		pp(True, has_called_ambulance)
	
def helping_boy(has_called_ambulance):
	print "What is your course of action?"
	action1 = lower(raw_input("> "))
	if "help"in action1 or "belt" in action1 or "hurt" in action1 or "out" in action1 or "unsecure" in action1 or "free" in action1:
		print "After carefully unplugging the boy's seatbelt and getting him out of the car,"
		print "you lay him on the ground a step away from the vehicle."
		print "You check the boy's pulse"
		sleep(3)
		print "\"HE'S OKAY!\" You yell to the boy's mother."
		sleep(2)
		print "\"He's okay!\" You say in a calmer tone."
		help_mother(has_called_ambulance)
	elif "check" in action1 or "pulse" in action1 or "alive" in action1 or "wake" in action1:
		print "After chechking the boy's pulse, he is alive but not coming around."
		print "You, carefully take off the seatbelt securing the boy."
		print "you lay him on the ground a step away from the vehicle."
		print "You check the boy's pulse"
		sleep(3)
		print "\"HE'S OKAY!\" You yell to the boy's mother."
		sleep(2)
		print "\"He's okay!\" You say in a calmer tone."
		help_mother(has_called_ambulance)
	else:
		print "\"PLEASE HELP ME! HELP MY SON! PLEASE CHECK IF HE IS ALIVE!!"
		print "\"PLEEASE HELP!"
		helping_boy(has_called_ambulance)
		

def help_mother(ambulance_coming):
	print """
You go to help the lady in the driver's seat of the car.
She seems to have a broken shoulder.
You secure her and unsecure her seat-belt.
You help her get on to her feet and you walk her to her son.
	"""
	print """
She gets to the ground to touch him and she sighs in relief when she feels him breathing
	"""
	if(ambulance_coming):
		ambulance_arrive(True)
	else:
		die(True)
		final_sequence(7)
		

def ambulance_arrive(has_helped):
	if has_helped:
		wake_peter()
		print"""
Two ambulances arrive with blaring sirens.
They halt ahead of you and several medics rush out of them towards you, the lady and her son.
They tend to each of you separately and one attending to you asks you something.
As she does you see a police car racing to the scene.
The voices all around you seem to fade""",
		sleep(2.8)
		final_sequence(5)
	elif not has_helped:
		print "You wait in your car for an ambulance to come."
		final_sequence(5)
		print "\nYou start seeing some flashing lights approaching from afar."
		print """
Ambulances arrive with blaring sirens.
The voice from the car ahead of you call out for help.
Some medics rush to the car and another rushes to yours.
You also call for help as the medic approaches.
She calls for another person from the ambulance to help set you free.
You see the lights of a police car racing to the scene.""",
		sleep(3)
		final_sequence(8)